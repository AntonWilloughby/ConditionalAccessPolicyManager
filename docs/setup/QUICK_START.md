# ğŸš€ Quick Start Guide - For Anyone Forking This Repo

**Time to First Run**: 5-10 minutes (plus Azure setup if needed)

---

## âœ… Prerequisites

You need:

1. **Python 3.11 or 3.12** installed
2. **Azure AD App Registration** (for authentication)
3. **Git** (to clone/fork the repo)

---

## ğŸ“¦ Automated Setup - Choose Your Platform

### Windows (PowerShell)

```powershell
# 1. Clone or fork the repository
git clone https://github.com/YOUR_USERNAME/ConditionalAccessPolicyManager.git
cd ConditionalAccessPolicyManager

# 2. Run automated setup
.\setup-local.ps1

# 3. Edit .env file with your Azure credentials
notepad CA_Policy_Manager_Web\.env

# 4. Stop any running dev server so environment changes reload
Stop-Process -Name python -Force -ErrorAction SilentlyContinue

# 5. Start the app
cd CA_Policy_Manager_Web
python app.py

# 6. Open browser
# http://localhost:5000
```

### Linux/macOS (Bash)

```bash
# 1. Clone or fork the repository
git clone https://github.com/YOUR_USERNAME/ConditionalAccessPolicyManager.git
cd ConditionalAccessPolicyManager

# 2. Make setup script executable
chmod +x setup-local.sh

# 3. Run automated setup
./setup-local.sh

# 4. Edit .env file with your Azure credentials
nano CA_Policy_Manager_Web/.env
# or: vim CA_Policy_Manager_Web/.env

# 5. Stop any running dev server so environment changes reload
pkill -f "python app.py" 2>/dev/null || true

# 6. Start the app
cd CA_Policy_Manager_Web
python app.py

# 7. Open browser
# http://localhost:5000
```

---

## ğŸ” Azure App Registration Setup

If you don't have Azure credentials yet:

### Option 1: Automated Script (Recommended)

```powershell
# Windows
cd scripts
.\Register-EntraApp-Delegated.ps1

# The script will:
# âœ… Create App Registration
# âœ… Configure permissions
# âœ… Generate credentials
# âœ… Update your .env file
```

### Option 2: Manual Setup (5 minutes)

See detailed guide: [docs/QUICK_SETUP.md](docs/QUICK_SETUP.md)

**Quick Steps**:

1. Go to [Azure Portal](https://portal.azure.com) â†’ App Registrations
2. Click "New registration"
3. Set redirect URI: `http://localhost:5000/auth/callback`
4. Add API permissions: `Policy.Read.All`, `Policy.ReadWrite.ConditionalAccess`
5. Create client secret
6. Copy Client ID and Secret to `.env`

---

## ğŸ“‹ What the Setup Script Does

The automated setup script (`setup-local.ps1` or `setup-local.sh`):

1. âœ… **Validates Python** â€“ Accepts only real Python 3.11 or 3.12 installs and tells you when it finds unsupported versions (3.13/3.14)
2. âœ… **Creates Virtual Environment** â€“ Isolated Python environment in `.venv/`
3. âœ… **Installs Dependencies** â€“ All 13 packages from `requirements.txt` with an upgraded `pip`
4. âœ… **Generates SECRET_KEY** â€“ Cryptographically secure session key
5. âœ… **Creates .env File** â€“ Enables `DEMO_MODE=true` so you can load the UI without Azure credentials
6. âœ… **Post-Setup Tips** â€“ Highlights missing `MSAL_CLIENT_ID` and reminds you to restart Python after editing `.env`

**Total Time**: ~2-3 minutes (depending on internet speed)

---

## ğŸ§ª Verify Installation

After setup, run validation:

```powershell
# Validate all 7 security fixes are in place
.\validate-security-fixes.ps1

# Expected output:
# âœ… Test 1: No hardcoded credentials
# âœ… Test 2: Debug mode controlled
# âœ… Test 3: SSL verification defaults
# âœ… Test 4: Session manager exists
# âœ… Test 5: Error handling sanitized
# âœ… Test 6: CSRF protection enabled
# âœ… Test 7: Security headers configured
#
# Result: âœ… All 7/7 security fixes verified!
```

---

## ğŸ“ Project Structure After Setup

```
ConditionalAccessPolicyManager/
â”œâ”€â”€ .venv/                          # Virtual environment (created by setup)
â”œâ”€â”€ CA_Policy_Manager_Web/
â”‚   â”œâ”€â”€ .env                        # YOUR credentials (created by setup)
â”‚   â”œâ”€â”€ .env.example                # Template with documentation
â”‚   â”œâ”€â”€ app.py                      # Main Flask application
â”‚   â”œâ”€â”€ config.py                   # Configuration management
â”‚   â”œâ”€â”€ session_manager.py          # Session storage
â”‚   â”œâ”€â”€ requirements.txt            # Python dependencies
â”‚   â””â”€â”€ ...
â”œâ”€â”€ docs/                           # Detailed documentation
â”œâ”€â”€ scripts/                        # Helper scripts
â”œâ”€â”€ setup-local.ps1                 # Windows setup script
â”œâ”€â”€ setup-local.sh                  # Linux/macOS setup script
â”œâ”€â”€ validate-security-fixes.ps1     # Security validation
â””â”€â”€ QUICK_START.md                  # This file
```

---

## ğŸ¯ Minimal .env Configuration

After running setup, edit `CA_Policy_Manager_Web/.env`:

```bash
# Required once DEMO_MODE=false
MSAL_CLIENT_ID=your_app_id_here

# Optional (only for client credential flows)
MSAL_CLIENT_SECRET=your_secret_here

# Auto-generated by setup script (don't change)
SECRET_KEY=<already_set>

# Optional - Development settings
FLASK_ENV=development
VERIFY_SSL=true
```

**Where to find Azure values**:

- `MSAL_CLIENT_ID`: Azure Portal â†’ App Registration â†’ Overview â†’ Application (client) ID
- `MSAL_CLIENT_SECRET`: Azure Portal â†’ App Registration â†’ Certificates & secrets â†’ New client secret

---

## ğŸš€ Running the Application

### First Time Setup

```powershell
# Windows
.\setup-local.ps1

# Linux/macOS
./setup-local.sh
```

### Every Time You Start Working

```powershell
# Windows
Stop-Process -Name python -Force -ErrorAction SilentlyContinue
cd CA_Policy_Manager_Web
python app.py

# Linux/macOS
pkill -f "python app.py" 2>/dev/null || true
source .venv/bin/activate
cd CA_Policy_Manager_Web
python app.py
```

### Expected Output

```
âš ï¸ Running in DEVELOPMENT mode - do not use in production!
 * Serving Flask app 'app'
 * Debug mode: on
 * Running on http://127.0.0.1:5000
 * Press CTRL+C to quit
```

Open browser to: **http://localhost:5000**

---

## ğŸ› Troubleshooting

### Python Not Found

```powershell
# Windows - Install from python.org
# Download: https://www.python.org/downloads/
# During install: Check "Add Python to PATH"

# Linux/Ubuntu
sudo apt update
sudo apt install python3.11 python3.11-venv

# macOS
brew install python@3.11
```

### Dependencies Fail to Install

```powershell
# Upgrade pip first
pip install --upgrade pip

# Install manually
cd CA_Policy_Manager_Web
pip install -r requirements.txt --verbose
```

### Port Already in Use

```powershell
# Use different port
$env:PORT="5001"
python app.py

# Or find and kill process on port 5000
# Windows
netstat -ano | findstr :5000
taskkill /PID <process_id> /F

# Linux/macOS
lsof -ti:5000 | xargs kill
```

### Virtual Environment Issues

```powershell
# Delete and recreate
Remove-Item .venv -Recurse -Force    # Windows
rm -rf .venv                          # Linux/macOS

# Re-run setup
.\setup-local.ps1                    # Windows
./setup-local.sh                     # Linux/macOS
```

### Azure Authentication Errors

```powershell
# Check .env file has correct values
Get-Content CA_Policy_Manager_Web\.env | Select-String "MSAL"

# Common issues:
# âŒ MSAL_CLIENT_ID=your_app_id_here  (not replaced)
# âœ… MSAL_CLIENT_ID=12345678-abcd-1234-abcd-123456789abc  (actual GUID)

# Verify redirect URI in Azure Portal:
# Must be: http://localhost:5000/auth/callback
```

---

## ğŸ“š Additional Resources

| Document                           | Purpose                             | Time   |
| ---------------------------------- | ----------------------------------- | ------ |
| **QUICK_START.md**                 | This file - fastest path to running | 5 min  |
| **LOCAL_TESTING_GUIDE.md**         | Detailed testing and verification   | 20 min |
| **docs/QUICK_SETUP.md**            | Azure AD setup instructions         | 15 min |
| **docs/DEPLOY_TO_AZURE_BUTTON.md** | One-click Azure deployment          | 10 min |
| **SECURITY_FIXES_COMPLETE.md**     | Security improvements summary       | 5 min  |

---

## âœ… Success Checklist

Before you start developing, verify:

- [ ] Python 3.11 or 3.12 installed
- [ ] Setup script completed successfully
- [ ] `.env` file created with Azure credentials
- [ ] Virtual environment activated
- [ ] Dependencies installed (15 packages)
- [ ] App starts without errors
- [ ] Can access http://localhost:5000
- [ ] Authentication redirects to Microsoft login
- [ ] Security validation passes (7/7 tests)

---

## ğŸ‰ You're Ready!

If all checks pass, you're ready to:

- âœ… Develop new features
- âœ… Test Conditional Access policies
- âœ… Customize for your organization
- âœ… Deploy to Azure (see deployment docs)

---

## ğŸ’¡ Pro Tips

### Daily Development

```powershell
# No need to run setup every time!
# Just activate venv and run:
cd CA_Policy_Manager_Web
python app.py
```

### Before Committing Code

```powershell
# Always validate security fixes
.\validate-security-fixes.ps1

# Should show: âœ… All 7/7 security fixes verified!
```

### Working with Multiple Tenants

```powershell
# Create different .env files
cp .env .env.tenant1
cp .env .env.tenant2

# Switch between them
cp .env.tenant1 .env
python app.py
```

### Production Deployment

```powershell
# See deployment guide
cat docs/DEPLOYMENT.md

# Or use one-click deploy
cat docs/DEPLOY_TO_AZURE_BUTTON.md
```

---

**Questions?** Check the comprehensive [LOCAL_TESTING_GUIDE.md](LOCAL_TESTING_GUIDE.md) or raise an issue on GitHub.

**Found a bug?** Security issues â†’ See [SECURITY.md](SECURITY.md) | Other bugs â†’ Open a GitHub issue

---

**Made with â¤ï¸ for IT Admins managing Conditional Access Policies**
